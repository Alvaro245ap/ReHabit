<!doctype html>
<html lang="en" data-lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ReHabit</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="manifest" href="manifest.webmanifest">
  <!-- Service worker can be re-enabled after everything works -->
  <!-- <script>navigator.serviceWorker.register('service-worker.js', { scope: './' });</script> -->
</head>
<body>
  <header class="topbar">
    <button id="menuBtn" aria-label="Open menu">☰</button>
    <h1>ReHabit</h1>
    <div class="lang-gear">
      <select id="langSelect" aria-label="Language">
        <option value="en">English</option>
        <option value="es">Español</option>
      </select>
    </div>
  </header>

  <!-- Drawer -->
  <aside id="drawer" class="drawer">
    <button id="closeDrawer" class="close">×</button>
    <nav>
      <a class="drawer-link" data-nav="home">🏠 Home</a>
      <a class="drawer-link" data-nav="calendar">🗓 Calendar</a>
      <a class="drawer-link" data-nav="checkin">📋 Check-in</a>
      <a class="drawer-link" data-nav="sos">🚨 SOS</a>
      <a class="drawer-link" data-nav="guide">📚 Guide</a>
      <a class="drawer-link" data-nav="research">🔎 Research</a>
      <a class="drawer-link" data-nav="community">💬 Community</a>
      <a class="drawer-link" data-nav="friends">🤝 Friends</a>
      <a class="drawer-link" data-nav="badges">🏅 Badges</a>
      <a class="drawer-link" data-nav="notes">📝 Notes</a>
      <a class="drawer-link" data-nav="settings">⚙️ Settings</a>
    </nav>
  </aside>
  <div id="backdrop" class="backdrop" hidden></div>

  <!-- Tabbar (mobile) -->
  <footer class="tabbar">
    <button class="tabbtn" data-nav="home">Home</button>
    <button class="tabbtn" data-nav="calendar">Calendar</button>
    <button class="tabbtn" data-nav="checkin">Check-in</button>
    <button class="tabbtn" data-nav="community">Chat</button>
    <button class="tabbtn" data-nav="friends">Friends</button>
  </footer>

  <main class="container">
    <!-- Onboarding -->
    <section id="view-onboarding">
      <div class="card">
        <h2 data-i18n="welcome">Welcome 👋</h2>
        <p data-i18n="selectFocus">Select your focus and a target date to start tracking progress.</p>
        <form id="onboardingForm">
          <fieldset>
            <legend data-i18n="chooseAddictions">Choose addictions</legend>
            <label><input type="checkbox" name="focus" value="Technology"> <span data-i18n="a_tech">Technology</span></label>
            <label><input type="checkbox" name="focus" value="Smoking"> <span data-i18n="a_smoke">Smoking</span></label>
            <label><input type="checkbox" name="focus" value="Alcohol"> <span data-i18n="a_alcohol">Alcohol</span></label>
            <label><input type="checkbox" name="focus" value="Gambling"> <span data-i18n="a_gambling">Gambling</span></label>
            <label><input type="checkbox" name="focus" value="Other"> <span data-i18n="a_other">Other drugs</span></label>
          </fieldset>
          <label>
            <span data-i18n="quitDate">Quit/target date</span>
            <input type="date" name="quitDate" />
          </label>
          <label>
            <span data-i18n="motivation">Your main motivation (optional)</span>
            <input type="text" name="motivation" />
          </label>
          <button type="submit" class="btn primary" id="startBtn" data-i18n="start">Start ReHabit</button>
        </form>
      </div>
    </section>

    <!-- Home -->
    <section id="view-home" hidden>
      <div class="grid2">
        <div class="card">
          <div class="card-head">
            <h3 data-i18n="monthCard">Calendar (this month)</h3>
            <div id="monthLabel" class="month"></div>
            <div id="streakWrap" class="streak"></div>
          </div>
          <div id="calendarGrid" class="calgrid"></div>
        </div>
        <div class="card">
          <div class="flex between">
            <h3 data-i18n="steps">10 Steps</h3>
            <div id="homeStepsChoice" hidden>
              <select id="homeStepsSelect"></select>
            </div>
          </div>
          <ul id="homeStepsList" class="pill-list"></ul>
        </div>
      </div>
    </section>

    <!-- Calendar (full) -->
    <section id="view-calendar" hidden>
      <div class="card">
        <div class="card-head">
          <h3 data-i18n="calendar">Calendar</h3>
          <div id="monthLabel2" class="month"></div>
          <div id="streakWrap2" class="streak"></div>
        </div>
        <div id="calendarGrid2" class="calgrid"></div>
      </div>
    </section>

    <!-- Check-in -->
    <section id="view-checkin" hidden>
      <div class="card">
        <h3 data-i18n="checkin">Daily Check-in</h3>
        <p id="encouragement"></p>
        <form id="checkinForm" class="grid2">
          <label><span data-i18n="mood">Mood (0–10)</span> <input type="range" min="0" max="10" name="mood" value="5"></label>
          <label><span data-i18n="urge">Urge (0–10)</span> <input type="range" min="0" max="10" name="urge" value="3"></label>
          <label><span data-i18n="sleep">Hours of sleep</span> <input type="number" step="0.5" min="0" max="24" name="sleep" value="7"></label>
          <label>
            <span data-i18n="cravingWindow">Craving window</span>
            <select name="window">
              <option value="Morning" data-i18n="morning">Morning</option>
              <option value="Afternoon" data-i18n="afternoon">Afternoon</option>
              <option value="Evening" data-i18n="evening">Evening</option>
              <option value="Night" data-i18n="night">Night</option>
            </select>
          </label>
          <label class="span2"><span data-i18n="actionTook">Helpful action you took</span> <input type="text" name="action"></label>
          <fieldset class="span2">
            <legend data-i18n="exposure">Exposure level today</legend>
            <label><input type="radio" name="exposure" value="Low" checked> <span data-i18n="low">Low</span></label>
            <label><input type="radio" name="exposure" value="Medium"> <span data-i18n="medium">Medium</span></label>
            <label><input type="radio" name="exposure" value="High"> <span data-i18n="high">High</span></label>
          </fieldset>
          <label class="span2"><span data-i18n="note">Note (optional)</span> <textarea name="note" rows="3"></textarea></label>
          <div class="span2 right"><button class="btn" type="submit">Save</button></div>
        </form>
      </div>
      <div class="card">
        <h4 data-i18n="recent">Recent notes</h4>
        <ul id="recentNotes" class="pill-list"></ul>
      </div>
    </section>

    <!-- SOS -->
    <section id="view-sos" hidden>
      <div class="card">
        <h3 data-i18n="sos">Craving SOS</h3>
        <ol>
          <li data-i18n="s1">Delay 5 minutes…</li>
          <li data-i18n="s2">Urge surfing…</li>
          <li data-i18n="s3">Do one alternative action…</li>
        </ol>
        <div class="timer-wrap">
          <div id="timer">01:00</div>
          <div class="btnrow">
            <button id="startTimer" class="btn">Start</button>
            <button id="resetTimer" class="btn subtle">Reset</button>
          </div>
        </div>
        <div class="chips" id="copingChips"></div>
        <textarea id="sosNote" rows="3" placeholder="Note…"></textarea>
        <div class="right"><button id="saveSos" class="btn">Save</button></div>
      </div>
    </section>

    <!-- Guide -->
    <section id="view-guide" hidden>
      <div class="card">
        <div class="flex between">
          <h3 id="guideTitle">Guide</h3>
        </div>
        <div id="guideChoiceWrap" class="right" hidden>
          <select id="guideChoice"></select>
        </div>
        <h4 data-i18n="tips">Tips</h4>
        <ul id="tab-tips" class="pill-list"></ul>
        <h4 data-i18n="deep">Deep Guide</h4>
        <ul id="tab-deep" class="pill-list"></ul>
      </div>
    </section>

    <!-- Research -->
    <section id="view-research" hidden>
      <div class="card">
        <div id="researchChoiceWrap" class="right" hidden>
          <select id="researchChoice"></select>
        </div>
        <h3 data-i18n="research">Research</h3>
        <ul id="researchBody" class="pill-list"></ul>
      </div>
    </section>

    <!-- Community -->
    <section id="view-community" hidden>
      <div class="card">
        <h3>Community (global)</h3>
        <div id="globalChat" class="chat-box-static"></div>
        <form id="globalForm" class="chat-send">
          <input name="msg" placeholder="Type…" />
          <button class="btn">Send</button>
        </form>
      </div>
    </section>

    <!-- Friends -->
    <section id="view-friends" hidden>
      <div class="card">
        <h3 data-i18n="friends">Friends</h3>
        <p><strong data-i18n="yourCode">Your code:</strong> <span id="myUid">—</span></p>
        <form id="addFriendForm" class="row">
          <input name="code" placeholder="Enter code…" />
          <button class="btn">Send request</button>
        </form>
      </div>
      <div class="card">
        <h4 data-i18n="requests">Requests</h4>
        <ul id="requestsList" class="list"></ul>
      </div>
      <div class="card">
        <h4 data-i18n="friendsList">Friends</h4>
        <ul id="friendList" class="list"></ul>
      </div>
    </section>

    <!-- Badges -->
    <section id="view-badges" hidden>
      <div class="card">
        <h3 data-i18n="badges">Badges</h3>
        <div id="sobrietyGrid" class="grid4"></div>
        <h4>Social</h4>
        <div id="socialGrid" class="grid4"></div>
        <p><strong data-i18n="currentTitle">Your current chat title</strong>: <span id="currentTitle">Newcomer</span></p>
      </div>
    </section>

    <!-- Notes -->
    <section id="view-notes" hidden>
      <div class="card">
        <h3 data-i18n="notes">Notes</h3>
        <ul id="notesList" class="pill-list"></ul>
      </div>
    </section>

    <!-- Settings -->
    <section id="view-settings" hidden>
      <div class="card">
        <h3 data-i18n="settings">Settings</h3>
        <form id="settingsForm" class="grid2">
          <label class="span2">Display Name <input name="displayName" /></label>
          <fieldset class="span2">
            <legend data-i18n="chooseAddictions">Choose addictions</legend>
            <label><input type="checkbox" name="addictions" value="Technology"> <span data-i18n="a_tech">Technology</span></label>
            <label><input type="checkbox" name="addictions" value="Smoking"> <span data-i18n="a_smoke">Smoking</span></label>
            <label><input type="checkbox" name="addictions" value="Alcohol"> <span data-i18n="a_alcohol">Alcohol</span></label>
            <label><input type="checkbox" name="addictions" value="Gambling"> <span data-i18n="a_gambling">Gambling</span></label>
            <label><input type="checkbox" name="addictions" value="Other"> <span data-i18n="a_other">Other drugs</span></label>
          </fieldset>
          <div class="span2 right"><button class="btn">Save</button></div>
        </form>
      </div>
    </section>
  </main>

  <footer class="foot">
    <small data-i18n="footer">For support only—does not replace professional treatment.</small>
    <small>© <span id="year"></span></small>
  </footer>

  <script src="app.js" defer></script>
</body>
</html>
